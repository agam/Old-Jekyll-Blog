
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Agam's Mashed-Up Pome</title>
	<meta name="author" content="Agam">

	
	<meta name="description" content="Don&rsquo;t blame the messenger. I just saw this and it&rsquo;s hilarious. Gilad Bracha is one of my new heroes now :) Watch this video and unless &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Agam's Mashed-Up Pome" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>

</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Agam's Mashed-Up Pome</a></h1>
<!-- DebugAgam: Uncomment if necessary!
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:agam.github.io">
			</form>
		</div>
	</div>
</nav>
-->
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/+AgamBrahma?rel=author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/agambrahma" title="Twitter">Twitter</a>
		
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
        <!-- DebugAgam: uncomment if necessary!
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:agam.github.io">
	</form>
        -->
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/24/fp-takedown/">
		
			FP Takedown</a>
	</h2>
	<div class="entry-content">
		<p>Don&rsquo;t blame the messenger. I just saw this and it&rsquo;s hilarious. Gilad Bracha is one of my new heroes now :)</p>

<p>Watch <a href="http://www.infoq.com/presentations/functional-pros-cons">this video</a> and unless you&rsquo;re an overly sensitive haskell zealot, you&rsquo;ll find some humor here. There&rsquo;s a lot of hype-busting and sacred-cow-killing.</p>

<p>Of course, he&rsquo;s no stranger to controversial programming views (<a href="http://gbracha.blogspot.com/2011/01/maybe-monads-might-not-matter.html">&ldquo;Maybe Monads Might Not Matter&rdquo;</a>, <a href="http://gbracha.blogspot.com/2011/06/types-are-anti-modular.html">&ldquo;Types are anti modular&rdquo;</a>, <a href="http://gbracha.blogspot.com/2009/11/objects-are-not-hash-tables.html">&ldquo;Objects are not hash tables&rdquo;</a>, and <a href="http://gbracha.blogspot.com/2009/12/chased-by-ones-own-tail.html">&ldquo;Chased by One&rsquo;s Own Tail&rdquo;</a>), so you might enjoy reading his blog after watching the video!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-24T06:22:00-08:00" pubdate data-updated="true">Dec 24<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/functional/'>functional</a>, <a class='category' href='/blog/categories/programming/'>programming</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/19/ranked-voting/">
		
			Ranked Voting</a>
	</h2>
	<div class="entry-content">
		<p>This one might actually make for a medium level interview question (assuming the problem can be successfully communicated)</p>

<p>Here is <a href="http://www.reddit.com/r/dailyprogrammer/comments/1r2mcz/112013_challenge_136_intermediate_ranked_voting/">the problem</a> (also found at the bottom of the gist)</p>

<div><script src='https://gist.github.com/8033346.js'></script>
<noscript><pre><code>#include &lt;cmath&gt;
#include &lt;cstdint&gt;
#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;
#include &lt;iomanip&gt;
#include &lt;iostream&gt;
#include &lt;limits&gt;
#include &lt;string&gt;
#include &lt;vector&gt;

using namespace std;

void GetVotes(
    const vector&lt;vector&lt;int&gt;&gt;&amp; votes,
    int loser_index,
    vector&lt;int&gt;* candidate_votes) {
  // Use the round# to determine if votes should be transferred.
  for (const vector&lt;int&gt;&amp; vote : votes) {
    int first_choice = vote[0];
    int second_choice = vote[1];
    if (loser_index &gt;= 0) {
      if (loser_index == first_choice) {
        ++((*candidate_votes)[second_choice]);
      }
    } else {
      // first pass; just add the votes
      ++((*candidate_votes)[first_choice]);
    }
  }
  if (loser_index &gt;=0) { ((*candidate_votes)[loser_index]) = 0; }
}

bool CheckMajority(const vector&lt;int&gt;&amp; candidate_votes, int total_votes, int* winner, int* loser) {
  int max_votes = 0, min_votes = total_votes;
  for (int i = 0; i &lt; candidate_votes.size(); ++i) {
    int v = candidate_votes[i];
    if (max_votes &lt; v) {
      max_votes = v;
      *winner = i;
    }
    if (min_votes &gt; v) {
      min_votes = v;
      *loser = i;
    }
  }
  if (max_votes * 2 &gt; total_votes) {
    return true;
  } else {
    return false;
  }
}

void PrintStats(const vector&lt;int&gt;&amp; candidate_votes, int total_votes, const vector&lt;string&gt;&amp; candidate_names) {
  for (int i = 0; i &lt; candidate_votes.size(); ++i) {
    if (candidate_votes[i] == 0) continue;
    cout &lt;&lt; fixed &lt;&lt; setprecision(2) &lt;&lt; (100.0 * candidate_votes[i])/total_votes &lt;&lt; &quot;% &quot; &lt;&lt; candidate_names[i];
    if (i &lt; candidate_votes.size() - 1) {
      cout &lt;&lt; &quot;, &quot;;
    }
  }
  cout &lt;&lt; endl;
}

int main() {
  int num_votes, num_candidates;
  cin &gt;&gt; num_votes &gt;&gt; num_candidates;
  cout &lt;&lt; &quot;Will read in &quot; &lt;&lt; num_votes &lt;&lt; &quot; votes for &quot; &lt;&lt; num_candidates &lt;&lt; &quot; candidates.&quot; &lt;&lt; endl;
  vector&lt;string&gt; candidate_names;
  vector&lt;vector&lt;int&gt;&gt; votes(num_votes, vector&lt;int&gt;(num_candidates));
  for (int i = 0; i &lt; num_candidates; ++i) {
    string name;
    cin &gt;&gt; name;
    candidate_names.push_back(name);
  }
  for (int i = 0; i &lt; num_votes; ++i) {
    for (int j = 0; j &lt; num_candidates; ++j) {
      cin &gt;&gt; votes[i][j];
    }
  }

  // Sanity check what we got.
  cout  &lt;&lt; &quot;Read in the following candidates :- \n&quot;;
  for (const string&amp; name : candidate_names) {
    cout &lt;&lt; name &lt;&lt; endl;
  }
  cout &lt;&lt; &quot;Read in the following votes :- \n&quot;;
  for (int i = 0; i &lt; num_votes; ++i) {
    for (int j = 0; j &lt; num_candidates; ++j) {
      cout &lt;&lt; votes[i][j] &lt;&lt; &quot; &quot;;
    }
    cout &lt;&lt; endl;
  }

  vector&lt;int&gt; candidate_votes(num_candidates);
  int round = 0, winner_index = -1, loser_index = -1;
  do {
    ++round;
    GetVotes(votes, loser_index, &amp;candidate_votes);
    cout &lt;&lt; &quot;Round &quot; &lt;&lt; round &lt;&lt; &quot;: &quot;;
    PrintStats(candidate_votes, num_votes, candidate_names);
  } while (!CheckMajority(candidate_votes, num_votes, &amp;winner_index, &amp;loser_index) &amp;&amp; round &lt; 10);
  cout &lt;&lt; candidate_names[winner_index] &lt;&lt; &quot; is the winner.\n&quot;;
}

/*
Input Description
-----------------
On standard console input, you will be given two space-delimited integers, N and M. N is the number of votes, while M is the number of candidates. After this line, you will be given the candidates line, which is a space-delimited set of M-number of candidate names. These names are one-word lower-case letters only. This is followed by N-lines of ballots, where each ballot is a list of M-integers, from 0 to M-1, representing the order of preference.
Note that the order of preference for ballots goes from left-to-right. The integers are the index into the candidate list. For the example below, you can map 0: Knuth, 1: Turing, 2: Church. This means that if the ballot row is &quot;1 0 2&quot;, that means the voter prefers Turing over Knuth over Church.

Output Description
------------------
Given the candidates and ballots, compute the first-round of successful candidates (e.g. rank them based on all ballot&#39;s first choice). If the percentage of votes for any one candidate is more than 50%, print the candidate name as the winner. Else, take all the votes of the least-successful candidate, and use their ballot&#39;s 2nd choice, summing again the total votes. If needed (e.g. there is no candidate that has more than 50% of the votes), repeat this process for the 3rd, 4th, etc. choice, and print the winner of the election.
For each round of computation, print the percentage of votes for each candidate, and rank them based on that percentage, using the output format.
*/
</code></pre></noscript></div>




		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-19T02:23:00-08:00" pubdate data-updated="true">Dec 19<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/alwaysbecoding/'>alwaysbecoding,</a>, <a class='category' href='/blog/categories/reddit/'>reddit</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/16/small-change-for-vim-and-git/">
		
			Small Change for Vim and Git</a>
	</h2>
	<div class="entry-content">
		<h2>Vim</h2>

<p>I hate seeing <code>.swp</code> and <code>~</code> files when I&rsquo;m editing. If I really need to go back to an earlier version of something there are other ways.</p>

<p>So I added this to my .vimrc:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>set nobackup
</span><span class='line'>set nowritebackup
</span><span class='line'>set noswapfile</span></code></pre></td></tr></table></div></figure>


<h2>Git</h2>

<p>If there&rsquo;s one config change to make for <code>git</code>, it should be this one:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git config --global --add color.ui true</span></code></pre></td></tr></table></div></figure>




		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-16T06:04:00-08:00" pubdate data-updated="true">Dec 16<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/git/'>git</a>, <a class='category' href='/blog/categories/vim/'>vim,</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/16/setting-up-screen/">
		
			Setting Up Screen</a>
	</h2>
	<div class="entry-content">
		<p>This is pretty much the first thing I do. I&rsquo;ve learned the hard way that I really really need persistent terminal state.</p>

<p>One of the changes I always make is to switch the default key combination away from <code>C-a</code>. Initially I did this during my &ldquo;year of trying Emacs&rdquo; (since it&rsquo;s the default &ldquo;move to beginning of line&rdquo; shortcut). I chose <code>C-z</code> (via <code>escape ^Zz</code>) but you might want to do this anyway if for example you feel <code>C-b</code> would be easier to type.</p>

<p>The other must-have is labels for the tabs. I want to know what I&rsquo;m switching between (a suitable modification to <code>hardstatus</code>).</p>

<p>The status line looks something like this.</p>

<p><img src="https://pbs.twimg.com/media/BblUW36CQAAG_Ol.png:large" alt="screen status with 3 tabs open" /></p>

<p>It&rsquo;s pretty minimal; you can add an arbitrary amount of customization to your status line, but this is all that I need.</p>

<p>Finally, there are a couple of &ldquo;features&rdquo; that <em>have</em> to be disabled: the screen flash on tab completion (<code>vbell off</code>), and the annoying startup message (<code>startup_message off</code>).</p>

<p>I&rsquo;m sure you know all about switching tabs, detaching and resuming sessions and all that. The only (in hindsight obvious) rule of thumb I&rsquo;ve learnt is to <em>always</em> launch a session with a name. Because you might just want to start two sessions. And then when it comes time to resume them, you won&rsquo;t know which is which. So make <code>screen -S &lt;sessionname&gt;</code> your friend.</p>

<p>Anyway I have a github repo for my &ldquo;dotfiles&rdquo; and you can see my basic screenrc <a href="https://github.com/agam/dotfiles/blob/master/.screenrc">here</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-16T05:30:00-08:00" pubdate data-updated="true">Dec 16<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/screen/'>screen</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/16/starting-from-scratch-on-a-vm/">
		
			Starting From Scratch on a VM</a>
	</h2>
	<div class="entry-content">
		<p>I&rsquo;ve started from scratch many times on new linux installations. It gets old after a while though, so I prefer to do it as infrequently as possible.</p>

<p>Getting started with a bare-bones VM is one of the occasions for this, so I&rsquo;ll take the time to record what I do so that I don&rsquo;t have to revisit this stuff the <em>next time</em>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-16T03:41:00-08:00" pubdate data-updated="true">Dec 16<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/vm/'>vm</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/14/adding-social-elements-to-octopress/">
		
			Adding Social Elements to Octopress</a>
	</h2>
	<div class="entry-content">
		<p>This is almost too easy. Octopress already comes with basic integration options built-in.</p>

<p>See <a href="http://jekyllrb.com/docs/configuration/">here</a> for more details than I care about, but the short version is that you just have to edit <code>_config.yml</code> and fill in fields for your Google+ username, a true/false value indicating whether users can share your posts on Google+/Twitter, a Disqus shortname for comments, a Google Analytics tracking code &hellip; you get the idea.</p>

<p>(though there seems to be some <a href="http://blog.jmac.org/blog/2013/03/30/putting-twitter-back-into-octopress/">extra work</a> required to get Twitter to show up in the sidebar.</p>

<p>While we&rsquo;re at it, might as well change the theme too. There&rsquo;s a huge collection of options at <a href="http://opthemes.com/">OPThemes</a>. So, pick one and replace the default dark grey one!</p>

<p>The usual flow is something like <code>git submodule add &lt;the theme's git repo&gt;</code> followed by <code>rake install["&lt;the theme name&gt;"]</code></p>

<p>I picked <a href="http://alexgaribay.com/"><code>octoflat</code></a> which doesn&rsquo;t have a sidebar, but is otherwise pleasing to look at.</p>

<p>Happy customizing!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-14T18:22:00-08:00" pubdate data-updated="true">Dec 14<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/octopress/'>octopress,</a>, <a class='category' href='/blog/categories/social/'>social</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/14/augmenting-my-chromebook-with-a-vm/">
		
			Augmenting My Chromebook With a VM</a>
	</h2>
	<div class="entry-content">
		<p>I had tried this out about a year ago, creating a small VM instance on Google Compute Engine. But a maintenance window occurred, my VM died, and that was that. I cleaned up and walked away.</p>

<h2>Comparison</h2>

<p>Sometime back, I heard about <a href="https://www.digitalocean.com/">Digital Ocean</a> from a friend. I had just switched to a chromebook and was missing the shell of my previous Linux laptop. So I once again looked into the current cloud offerings.</p>

<p>There is an excellent comparison at <a href="http://cloudpricegrid.com/">cloud price grid</a> so I won&rsquo;t waste time repeating that.</p>

<p>DigitalOcean seems the cheapest for a couple of options</p>

<ul>
<li><em>1core/512Mb/20G &mdash;> $5/mo</em></li>
<li><em>1core/1G/30G  &mdash;> $10/mo</em></li>
</ul>


<p>(See <a href="https://www.digitalocean.com/pricing/">detailed pricing</a>)</p>

<p>However, this is without any firewall or networking capability, and the datacenter seems to be near New York, so that&rsquo;s something to keep in mind.</p>

<p>Meanwhile at Google Compute Engine, the right comparison would be with a combination of</p>

<ul>
<li><em>Persistent disk &mdash;> 20G for $0.8/mo</em></li>
<li><em>f1-micro [1core/600Mb] &mdash;> $0.019/hr</em>
[which by the way at max utilization turns out to be $13.78/mo]</li>
</ul>


<p>(See <a href="https://cloud.google.com/products/compute-engine/#pricing">detailed pricing</a>)</p>

<p>A similar comparison for Amazon (I could be off in apples-to-apples here (what I think are apples may in fact be oranges))</p>

<p><em>t1.micro [1core/630Mb] &mdash;> $0.025/hr</em></p>

<p>So the cheapest Amazon has to offer seems more expensive than the cheapest Google has to offer (both of these instances will be pretty useless for hosting something substantial, but we&rsquo;re assuming the idea here is to have a small &ldquo;developer space&rdquo;).</p>

<p>But keep in mind Amazon also has a <a href="http://aws.amazon.com/free/">free tier</a> so if you just want to try it out for a year, the micro instance is actually FREE (!)</p>

<h2>Getting (re-)started with Google Compute Engine</h2>

<p>I elected to stay with Google. The new <a href="https://cloud.google.com/console#/project">cloud console</a> is much better than it was before, with a nice grouping by project and sub-links to Appengine, CloudSql, CloudStorage, ComputeEngine, etc.</p>

<p>Within the Cloud Engine dashboard, it is possible (and in fact, easy) to create a new VM, set up its associated disk and static IPs, OS, etc from the UI.</p>

<h2>SSHing</h2>

<p>One thing to point out is that the first time I set it up I used the <code>gcutil</code> tool to ssh into the instance; this creates local ssh keys and uploads the public key to the instance (it can be viewed in the <code>Metadata</code> part of the console). So I had to do this from a non-chromebook &ldquo;real&rdquo; computer (though there may be a workaround I&rsquo;m unaware of).</p>

<p>For subsequent SSHs, the recommended way is to use a long SSH command</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>ssh -o <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null -o <span class="nv">CheckHostIP</span><span class="o">=</span>no -o  <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no <span class="se">\</span>
</span><span class='line'> -i &lt;key-file&gt; -o <span class="nv">LogLevel</span><span class="o">=</span>QUIET -A  -p <span class="m">22</span> &lt;username&gt;@&lt;ipaddress&gt;
</span></code></pre></td></tr></table></div></figure>


<p>and this worked when I tried it from the computer I signed up on.</p>

<p>Before trying to SSH from a chromebook, you have to copy ssh keys locally (how? I Dropbox&rsquo;d them and then deleted them from Dropbox, which is admittedly less secure &hellip; maybe I should have written it down and recreated manually?!).</p>

<p>Anyway, so once you have copied the keys, you can use the <a href="https://chrome.google.com/webstore/detail/secure-shell/pnhechapfaindjhompbnflcldabbghjo?hl=en">Secure Shell</a> app.</p>

<p>You have to click on <code>import...</code> to select the public/private key pair. At this point, when I used the long SSH command mentioned above, it didn&rsquo;t work. Eventually it only worked when I tried with a blank command (so the only arguments were username, host IP and the key file).</p>

<h2>Chromebook + VM</h2>

<p>Having tried this out for a while, I can&rsquo;t imagine living without it. Obviously it depends on internet access, but that&rsquo;s a common caveat these days.</p>

<p>But I strongly encourage it, since it&rsquo;s a perfect complement to the otherwise &ldquo;browser-only&rdquo; world.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-14T17:14:00-08:00" pubdate data-updated="true">Dec 14<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/chromebook/'>chromebook</a>, <a class='category' href='/blog/categories/vm/'>vm,</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/12/14/problems-with-octopress-in-a-new-location/">
		
			Problems With Octopress in a New Location</a>
	</h2>
	<div class="entry-content">
		<p>My git-n00bness obviously inhibited me a bit here, but I was today in the situation of creating a new location from which to blog (a hosted VM, more about which in a separate post).</p>

<p>So I ran <code>git clone https://github.com/agam/agam.github.io.git</code>, which gave me the <code>master</code> branch.</p>

<p>But I also needed the <code>source</code> branch. So I naively ran <code>git pull origin source</code>, which resulted in &hellip; a merge conflict on <code>index.html</code>?! WTF?</p>

<p>I &lsquo;fixed&rsquo; that by making <code>index.html</code> empty. But <code>rake generate</code> failed with weird errors and <code>git branch</code> still shows only <code>source</code>. So what was wrong?</p>

<p><a href="http://stackoverflow.com/questions/67699/how-do-i-clone-all-remote-branches-with-git">This stackoverflow post</a> had a possible answer on how to proceed.</p>

<p>I tried running <code>git checkout origin/source</code> but that brought on the dreaded <code>experimental HEAD</code> error message.</p>

<p>No luck. Then I came across <a href="http://blog.zerosharp.com/clone-your-octopress-to-blog-from-two-places/">this post</a> which seemed to describe a similar situation (I crossed my fingers that I hadn&rsquo;t already screwed up my repo).</p>

<p>Aha! (I won&rsquo;t forget it now). You&rsquo;re supposed to specify the branch name when you check out!</p>

<p>So I <code>rm -rf</code>ed my setup, then ran the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>git clone -b <span class="nb">source </span>https://github.com/agam/agam.github.io.git
</span><span class='line'><span class="nb">cd </span>agam.github.io
</span><span class='line'>git clone https://github.com/agam/agam.github.io.git _deploy
</span></code></pre></td></tr></table></div></figure>


<p>After this, <code>rake new_post</code> worked as expected, but <code>rake generate</code> still failed on some plugin error about an &ldquo;invalid byte sequence&rdquo;.</p>

<p>That led me to <a href="https://gist.github.com/arnab/4584901">this gist</a>. <code>export LANG=en_US.utf-8</code> fixed the generate problem.</p>

<p>And then <code>rake deploy</code> worked as expected, so yay!</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-12-14T05:43:00-08:00" pubdate data-updated="true">Dec 14<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/octopress/'>octopress</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/11/26/moar-reddit-dailyprogramming-falling-sand/">
		
			Moar Reddit DailyProgramming: Falling Sand</a>
	</h2>
	<div class="entry-content">
		<p>Another <a href="http://www.reddit.com/r/dailyprogrammer/comments/1rdtky/111113_challenge_142_easy_falling_sand/">easy challenge</a>.</p>

<p>One thing I learnt while doing this: I had to test the program with standard
input and had created a couple of files with sample input that I could pipe in.
I wasted a lot of time debugging a spurious newline (!), so in the future I
should remember to do the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">set </span><span class="nv">listchars</span><span class="o">=</span>eol:<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>What this does is show you <code>$</code> wherever the file has <code>\n</code> in it, so you can use
this to distinguish between &lsquo;real&rsquo; spaces and whitespace.</p>

<div><script src='https://gist.github.com/7669304.js'></script>
<noscript><pre><code>#include &lt;cmath&gt;
#include &lt;cstdint&gt;
#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;
#include &lt;iostream&gt;
#include &lt;limits&gt;
#include &lt;string&gt;
#include &lt;vector&gt;

using namespace std;

void PrintGrid(const vector&lt;vector&lt;char&gt;&gt;&amp; grid) {
  for (int i = 0; i &lt; grid.size(); ++i) {
    for (int j = 0; j &lt; grid.size(); ++j) {
      cout &lt;&lt; grid[i][j];
    }
    cout &lt;&lt; endl;
  }
}

bool GridFall(vector&lt;vector&lt;char&gt;&gt;* grid) {
  bool changed = false;
  // Skip row above ground
  for (int i = grid-&gt;size() - 2; i &gt;= 0; --i) {
    auto&amp; current_row = grid-&gt;at(i);
    auto&amp; next_row = grid-&gt;at(i + 1);
    for (int j = 0; j &lt; grid-&gt;size(); ++j) {
      if (current_row[j] == &#39;.&#39; &amp;&amp; next_row[j] == &#39; &#39;) {
        changed = true;
        current_row[j] = &#39; &#39;;
        next_row[j] = &#39;.&#39;;
      }
    }
  }
  return changed;
}

int main() {
  int grid_size;
  cin &gt;&gt; grid_size;

  vector&lt;vector&lt;char&gt;&gt; grid(grid_size);
  char dummy_newline;
  cin.get(dummy_newline);
  cin &gt;&gt; noskipws;
  for (int i = 0; i &lt; grid_size; ++i) {
    for (int j = 0; j &lt; grid_size; ++j) {
      char grid_char;
      cin.get(grid_char);
      grid[i].push_back(grid_char);
    }
    cin.get(dummy_newline);
  }

  do {
    // Uncomment to view/debug transitory steps.
    //cout &lt;&lt; &quot;Intermediate grid state :- &quot; &lt;&lt; endl;
    //PrintGrid(grid);
  } while (GridFall(&amp;grid));

  PrintGrid(grid);

  return 0;
}

/*
 * Input Description
 * On standard console input, you will be given an integer N which represents
 * the N x N grid of ASCII characters. This means there will be N-lines of
 * N-characters long. This is the starting grid of your simulated world: the
 * character &#39; &#39; (space) means an empty space, while &#39;.&#39; (dot) means sand, and
 * &#39;#&#39; (hash or pound) means stone. Once you parse this input, simulate the
 * world until all particles are settled (e.g. the sand has fallen and either
 * settled on the ground or on stone). &quot;Ground&quot; is defined as the solid surface
 * right below the last row.
 * Output Description
 * Print the end result of all particle positions using the input format for
 * particles.
 * Sample Inputs &amp; Outputs
 * Sample Input
 * 5
 * .....
 *   #  
 *   #    
 *
 *       .
 * Sample Output
 *   .  
 * . #  
 * #    
 *     .
 *  . ..
 */
</code></pre></noscript></div>




		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-11-26T17:33:00-08:00" pubdate data-updated="true">Nov 26<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/alwaysbecoding/'>alwaysbecoding</a>, <a class='category' href='/blog/categories/reddit/'>reddit,</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/11/26/reddit-dailyprogrammer-computing-pi/">
		
			Reddit DailyProgrammer Computing Pi</a>
	</h2>
	<div class="entry-content">
		<p>Another reddit programming exercise, <a href="http://www.reddit.com/r/dailyprogrammer/comments/1qply1/111513_challenge_129_hard_baking_pi/">this one</a> being classified as &lsquo;hard&rsquo; and indeed it <em>did</em> take a while longer, being a distributed programming setup.</p>

<h3>Implementation Notes</h3>

<ul>
<li>In a real world application, I would use something like Protocol Buffers for serialization</li>
<li>ditto for something like Thrift for RPCs</li>
<li>I had to add a sleep to each client so the first client doesn&rsquo;t run through
the whole batch on its own (machines are too fast these days!)</li>
<li>The run was limited to 250 digits, seemed to exhaust accuracy after about 254 digits with my implementation</li>
<li>Every client connects and sends &lsquo;-1&rsquo; before getting its first digit. On
subsequent connections it sends its current digit and computed value, and
receives the next digit to compute.</li>
</ul>


<h3>Server Code</h3>

<div><script src='https://gist.github.com/7667732.js'></script>
<noscript><pre><code>#include &lt;cmath&gt;
#include &lt;cstdint&gt;
#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;
#include &lt;iostream&gt;
#include &lt;limits&gt;
#include &lt;string&gt;
#include &lt;vector&gt;

#include &quot;Poco/Net/ServerSocket.h&quot;
#include &quot;Poco/Net/SocketAddress.h&quot;
#include &quot;Poco/Net/StreamSocket.h&quot;
#include &quot;Poco/Timespan.h&quot;

using namespace std;

int getNextDigit() {
  static int next_digit = -1;
  ++next_digit;
  return next_digit;
}

int main() {
  Poco::Net::ServerSocket srv(9090);
  cout &lt;&lt; &quot;Waiting for clients ...&quot; &lt;&lt; endl;

  // Arbitrary number of clients are supported. Each client is given the &#39;next&#39;
  // digit once it&#39;s done.

  double mysum = 3.0;  // used to sanity check
  static const float kComparisonMultiplier = 10000.0;
  for (;;) {
    Poco::Net::StreamSocket ss = srv.acceptConnection();
    ss.setReceiveTimeout(20000);
    ss.setSendTimeout(20000);
    int last_digit;
    unsigned int computed_value;
    char client_buf[10];
    ss.receiveBytes(client_buf, 10);
    sscanf(client_buf, &quot;%d-%u&quot;, &amp;last_digit, &amp;computed_value);
    cout &lt;&lt; &quot;Received &quot; &lt;&lt; last_digit
         &lt;&lt; &quot;th digit as &quot; &lt;&lt; hex &lt;&lt; computed_value &lt;&lt; dec &lt;&lt; endl;
    if (computed_value != 1000) {
      mysum += (1.0 * computed_value / pow(16.0, (last_digit + 1)));
      cout &lt;&lt; &quot;  Divergence from PI &quot;
           &lt;&lt; &quot;(to &quot; &lt;&lt; kComparisonMultiplier &lt;&lt; &quot; accuracy) so far = &quot;
           &lt;&lt; fabs((mysum - M_PI) * kComparisonMultiplier)  &lt;&lt; endl;
    }

    // Send next command
    int next_digit = getNextDigit();
    snprintf(client_buf, 10, &quot;*%d*&quot;, next_digit);
    ss.sendBytes(client_buf, 10);
    cout &lt;&lt; &quot;Sent &quot; &lt;&lt; client_buf &lt;&lt; endl;
  }
  return 0;
}

/*
 * Input Description
 * There is no formal input description, though this is the desired behavior:
 * You launch your main dispatcher-application on Computer A. You then launch
 * the computing-applications on Computer W, X, Y and Z. Computer A wants to
 * compute the first four digits of Pi, and sends the appropriate network
 * commands, one to each computer. Computer Y returns a result first, so the
 * dispatcher receives the data, saves in your output file the line &quot;0:2&quot;, and
 * then gives the command to compute the 5th digit of Pi. Computers X, Z, W
 * finish in that order, returning the results to the dispatcher, which in turn
 * saves in the same format. They are then asked to compute digits 6, 7, and 8.
 * This repeats until your dispatcher application sends a &quot;stop&quot; or &quot;kill&quot;
 * command to the computing processes. It is up to you how many hexadecimal
 * digits each process computes.
 * Output Description
 * For each computed base-16 (hexadecimal) digit of Pi, write to a file a line
 * of text in the format of &lt;Digit-Index&gt;:&lt;Computed-Digit&gt;. The order does not
 * matter, and you may skip digits. An example of the file, after eight computed
 * digits, would be as follows:
 * 0:2
 * 1:4
 * 2:3
 * 3:F
 * 4:6
 * 5:A
 * 6:8
 * 7:8
 */
</code></pre></noscript></div>


<h3>Client Code</h3>

<div><script src='https://gist.github.com/7667742.js'></script>
<noscript><pre><code>#include &lt;cmath&gt;
#include &lt;cstdint&gt;
#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;
#include &lt;iostream&gt;
#include &lt;limits&gt;
#include &lt;string&gt;
#include &lt;vector&gt;

#include &quot;Poco/Net/SocketAddress.h&quot;
#include &quot;Poco/Net/StreamSocket.h&quot;

using namespace std;

double Series(unsigned int digit, int j) {
  double termsum = 0.0;
  for (int k = 0; k &lt; digit; k++) {
    double numerator = pow(16.0, digit - k);
    double denominator = (8 * k + j);
    termsum += (numerator / denominator);
    termsum -= floor(termsum);
  }
  for (int k = digit; ; k++) {
    double numerator = 1.0;
    double denominator = (8 * k + j) * pow(16, k - digit);
    double fraction = numerator / denominator;
    if (fraction - 0.0  &lt; 1e-32) break;
    termsum += (numerator / denominator);
    termsum -= floor(termsum);
  }
  return termsum;
}

double ComputePiDigit(unsigned int digit) {
  double value = (4 * Series(digit, 1) -
                  2 * Series(digit, 4) -
                  1 * Series(digit, 5) -
                  1 * Series(digit, 6));
  value = value - (unsigned long long) value + 1.0;
  return value;
}

// Special case for very first client connection: digitNum == -1
// Value has valid hex range, or else &#39;1000&#39;

struct PiState {
  int digitNum;
  unsigned int value;
};

int main(int argc, char **argv) {
  cout &lt;&lt; &quot;Connecting to &quot; &lt;&lt; argv[1] &lt;&lt; &quot;:&quot; &lt;&lt; argv[2] &lt;&lt; endl;
  static const int kMaxDigits = 250;
  // Connect to the server, work with upto 10000 digits, then stop.
  Poco::Net::SocketAddress sa(argv[1], atoi(argv[2]));
  PiState my_pi_state;
  // First request is special
  my_pi_state.digitNum = -1;;
  my_pi_state.value = 1000;

  while (my_pi_state.digitNum &lt; kMaxDigits) {

    Poco::Net::StreamSocket socket(sa);
    socket.setReceiveTimeout(100000);

    // contact server, give current result, get new digit to compute
    char bufstr[10];
    snprintf(bufstr, 10, &quot;%d-%u&quot;, my_pi_state.digitNum, my_pi_state.value);
    socket.sendBytes(bufstr, 10);
    socket.receiveBytes(bufstr, 10);
    sscanf(bufstr, &quot;*%d*&quot;, &amp;my_pi_state.digitNum);
    double calculated_value = ComputePiDigit(my_pi_state.digitNum);
    // common case: compute the current digit and send it to the server

    cout &lt;&lt; &quot;Digit: &quot; &lt;&lt; dec &lt;&lt; my_pi_state.digitNum &lt;&lt; &quot;...&quot;;
    float hexval = fabs(calculated_value);
    my_pi_state.value =
        static_cast&lt;unsigned int&gt;(16.0 * (hexval - floor(hexval)));
    cout &lt;&lt; &quot;Value: &quot; &lt;&lt; hex &lt;&lt; my_pi_state.value &lt;&lt; endl;

    // Anti-performance, but we want to work slowly here so I can start up
    // multiple clients and show their interleaved output :)
    sleep(1);
  }
  cout &lt;&lt; &quot;Pi Client exiting ...&quot; &lt;&lt; endl &lt;&lt; endl;
}
</code></pre></noscript></div>


<h3>Compiling</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>clang++ -std<span class="o">=</span>c++0x pi-compute-server.cpp  -lPocoNet -lPocoFoundation -o server
</span><span class='line'><span class="nv">$ </span>clang++ -std<span class="o">=</span>c++0x pi-compute-client.cpp  -lPocoNet -lPocoFoundation -o client
</span></code></pre></td></tr></table></div></figure>


<h3>Running</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>./server
</span><span class='line'>Waiting <span class="k">for</span> clients ...
</span><span class='line'>Received -1th digit as 1000
</span><span class='line'>Sent *0*
</span><span class='line'>Received 0th digit as 2
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 165.927
</span><span class='line'>Sent *1*
</span><span class='line'>Received -1th digit as 1000
</span><span class='line'>Sent *2*
</span><span class='line'>Received 1th digit as 4
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 9.67654
</span><span class='line'>Sent *3*
</span><span class='line'>Received 2th digit as 3
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 2.35232
</span><span class='line'>Sent *4*
</span><span class='line'>Received -1th digit as 1000
</span><span class='line'>Sent *5*
</span><span class='line'>Received 3th digit as 15
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 0.0634988
</span><span class='line'>Sent *6*
</span><span class='line'>Received 4th digit as 6
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 0.00627833
</span><span class='line'>Sent *7*
</span><span class='line'>...
</span><span class='line'>Sent *249*
</span><span class='line'>Received 246th digit as 1
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 0.00597909
</span><span class='line'>Sent *250*
</span><span class='line'>Received 247th digit as 0
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 0.00597909
</span><span class='line'>Sent *251*
</span><span class='line'>Received 248th digit as 11
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 0.00597909
</span><span class='line'>Sent *252*
</span><span class='line'>Received 249th digit as 3
</span><span class='line'>Divergence from PI <span class="o">(</span>to <span class="m">10000</span> accuracy<span class="o">)</span> so <span class="nv">far</span> <span class="o">=</span> 0.00597909
</span><span class='line'>Sent *253*
</span><span class='line'>^C
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>./client localhost 9090
</span><span class='line'>Connecting to localhost:9090
</span><span class='line'>Digit: 0...Value: 2
</span><span class='line'>Digit: 1...Value: 4
</span><span class='line'>Digit: 3...Value: f
</span><span class='line'>Digit: 6...Value: 8
</span><span class='line'>Digit: 9...Value: 5
</span><span class='line'>Digit: 13...Value: 8
</span><span class='line'>Digit: 17...Value: 0
</span><span class='line'>Digit: 21...Value: 7
</span><span class='line'>...
</span></code></pre></td></tr></table></div></figure>




		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-11-26T14:50:00-08:00" pubdate data-updated="true">Nov 26<sup>th</sup>, 2013</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/alwaysbecoding/'>alwaysbecoding</a>, <a class='category' href='/blog/categories/reddit/'>reddit,</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
        
            <a href="/posts/5" class="prev">Prev</a>
        
    
    
        <a href="/posts/7" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2014

    Agam

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'agamamp';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-16612682-4']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>
